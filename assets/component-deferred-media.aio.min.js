/*
Generated time: November 27, 2024 07:21
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
(()=>{class e extends HTMLElement{constructor(){super(),this.sectionId=this.getAttribute("data-section-id"),this.activeMediaClass=this.getAttribute("data-active-media-class"),this.mediaPlayButton=this.querySelector("[data-media-play-button]"),this.mediaId=this.getAttribute("data-media-id"),this.bindEventHandlers()}connectedCallback(){this.verifyInitialSetup(),this.registerEventListeners()}verifyInitialSetup(){this.mediaPlayButton||console.error("DeferredMedia: Play button not found!"),this.mediaId||console.error("DeferredMedia: Media ID not found!")}bindEventHandlers(){this.handleMediaClick=this.handleMediaClick.bind(this),this.handleMediaLoad=this.handleMediaLoad.bind(this),this.pauseAllMedia=this.pauseAllMedia.bind(this)}registerEventListeners(){eventBus.on("load:media",this.handleMediaLoad),eventBus.on("pause:media",this.pauseAllMedia),this.mediaPlayButton&&this.mediaPlayButton.addEventListener("click",this.handleMediaClick)}handleMediaLoad(e){e.mediaId===this.mediaId&&e.sectionId===this.sectionId&&this.loadMedia()}handleMediaClick(){this.loadMedia()}loadMedia(){var e;this.mediaId&&!this.getAttribute("data-media-loaded")&&(this.pauseAllMedia(),e=this.querySelector("template")?.content?.querySelector("[data-media-wrapper]"))&&(e=e.cloneNode(!0),this.innerHTML="",this.appendChild(e),this.setAttribute("data-media-loaded",!0),e.classList.add(this.activeMediaClass),this.postProcessMedia(e))}postProcessMedia(e){e=e.querySelector("video, iframe, model-viewer");e&&(e.style.pointerEvents="auto",this.loadSpecificMediaFeatures(e))}loadSpecificMediaFeatures(e){"MODEL-VIEWER"===e.tagName?this.loadModelFeatures(e):"VIDEO"===e.tagName&&e.getAttribute("autoplay")&&e.play().catch(e=>console.error("Error playing video:",e))}loadModelFeatures(i){Shopify.loadFeatures([{name:"model-viewer-ui",version:"1.0",onLoad:e=>{e||(e=new Shopify.ModelViewerUI(i),i.modelViewerUI=e,this.addModelInteractionListeners(i),this.initializeShopifyXR())}}])}addModelInteractionListeners(i){let t={mousedown:"disable-swiping",mouseup:"enable-swiping",touchstart:"disable-swiping",touchend:"enable-swiping"};["mousedown","mouseup","touchstart","touchend"].forEach(e=>{i.addEventListener(e,()=>{eventBus.emit(t[e],{sectionId:this.sectionId})})})}initializeShopifyXR(){Shopify.loadFeatures([{name:"shopify-xr",version:"1.0",onLoad:e=>{e||document.addEventListener("shopify_xr_initialized",()=>this.setupShopifyXR())}}])}setupShopifyXR(){document.querySelectorAll('[id^="ProductJSON-"]').forEach(e=>{window.ShopifyXR.addModels(JSON.parse(e.textContent)),e.remove()}),window.ShopifyXR.setupXRElements()}pauseAllMedia(){document.querySelectorAll(".js-youtube, .js-vimeo, video, model-viewer").forEach(e=>{var i;"IFRAME"===e.tagName?(i=e.src.includes("youtube")?"https://www.youtube.com":"https://player.vimeo.com",e.contentWindow.postMessage(this.messageFn("pause",e.src),i)):"VIDEO"===e.tagName?e.pause():"MODEL-VIEWER"===e.tagName&&e.modelViewerUI&&e.modelViewerUI.pause()})}messageFn(e,i){return i.includes("youtube")?JSON.stringify({event:"command",func:"play"===e?"playVideo":"pauseVideo",args:[]}):i.includes("vimeo")?JSON.stringify({method:e}):void 0}disconnectedCallback(){this.mediaPlayButton&&this.mediaPlayButton.removeEventListener("click",this.handleMediaClick),eventBus.off("load:media",this.handleMediaLoad),eventBus.off("pause:media",this.pauseAllMedia)}}customElements.get("deferred-media")||customElements.define("deferred-media",e)})();